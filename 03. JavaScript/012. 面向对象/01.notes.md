# é¢å‘å¯¹è±¡

## é¢å‘å¯¹è±¡çš„å¥½å¤„

å¥½å¤„ï¼š

1. æ›´æ–¹ä¾¿
2. å¤ç”¨æ€§å¥½
3. é«˜å†…èšä½è€¦åˆ
4. ä»£ç å†—ä½™åº¦ä½

ç‰¹æ€§ï¼š

1. å°è£…
2. ç»§æ‰¿
3. å¤šæ€

### 1. å°è£…

```js
// å‡è®¾éœ€è¦ç™»è®°å­¦ç±ï¼Œåˆ†åˆ«è®°å½•å°æ˜å’Œå°çº¢çš„å­¦ç±å·ã€å§“å
let name1 = 'å°æ˜'
let num1 = '040301'
let name2 = 'å°çº¢'
let num2 = '040302'

//å¦‚æœéœ€è¦ç™»è®°å¤§é‡çš„æ•°æ®ï¼Œå¼Šç«¯ä¼šéå¸¸æ˜æ˜¾ï¼Œä¸”ä¸å¥½ç»´æŠ¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ˜¯ç”¨ä¸‹é¢ğŸ‘‡çš„æ–¹æ³•æ¥ç™»è®°ï¼Œè¿™ä¹Ÿæ˜¯é¢å‘å¯¹è±¡çš„ç‰¹æ€§ä¹‹ä¸€ï¼šå°è£…
let p1 = {
  name: 'å°æ˜',
  num: '040301'
}
let p2 = {
  name: 'å°çº¢',
  num: '040302'
}
```

### 2. ç»§æ‰¿

```js
// ä»å·²æœ‰çš„å¯¹è±¡ä¸Šï¼Œè·å–å±æ€§ã€æ–¹æ³•
function Person() {
  this.name = 'wuyi'
}

Person.prototype.eat = function() {
  console.log('åƒé¥­')
}
let p1 = new Person()
p1.eat() // åƒé¥­

let p2 = new Person()
p2.eat()// åƒé¥­
```

### 3. å¤šæ€

```js
// åŒä¸€æ“ä½œï¼Œé’ˆå¯¹ä¸åŒå¯¹è±¡ï¼Œä¼šæœ‰ä¸åŒçš„ç»“æœ
let arr = [1,2,3]
arr.toString() //1,2,3

let obj = new Object()
obj.toString() //[object Object]
```

## å¦‚ä½•åˆ›å»ºå¯¹è±¡

1. å¯¹è±¡å­—é¢é‡
2. åˆ©ç”¨å†…ç½®å¯¹è±¡ new Object()
3. åˆ©ç”¨æ„é€ å‡½æ•°

### 1. å­—é¢é‡

> è¯¥æ–¹å¼çš„åŠ£åŠ¿æ¯”è¾ƒæ˜æ˜¾ï¼Œå°±æ˜¯æ— æ³•å¤ç”¨ï¼Œå¦‚æœåˆ›å»ºå¤§é‡åŒç±»å‹çš„å¯¹è±¡ï¼Œåˆ™ä»£ç ä¼šéå¸¸å†—ä½™

```js
let person = {
  name: 'wuyi',
  age: 24,
  eat: function() {
    console.log('åƒæ”¾')
  }
}
```

### 2. åˆ©ç”¨å†…ç½®å¯¹è±¡çš„æ–¹å¼åˆ›å»ºå¯¹è±¡

> è¯¥æ–¹å¼çš„åŠ£åŠ¿ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œå°±æ˜¯æ²¡åŠæ³•åˆ¤æ–­ç±»å‹

```js
function createObj(name, age) {
  let obj = new Object()
  obj.name = name
  obj.age = age
  return obj
}
let p1 = createObj('å°æ˜'ï¼Œ12)
let p2 = createObj('å°çº¢', 11)

console.log(p1 === p2) //false
console.log(p1.constructor) //Object æŒ‡å‘çš„æ„é€ å‡½æ•°æ˜¯Object
console.log(p2.constructor) //Object æŒ‡å‘çš„æ„é€ å‡½æ•°æ˜¯Object

// é‚£ä¹ˆä¸ºä»€ä¹ˆè¯´æ²¡åŠæ³•åˆ¤æ–­ç±»å‹å‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬åˆ›å»ºä¸€æ¡ç‹—çš„å¯¹è±¡
// å¯ä»¥çœ‹å‡ºï¼Œç‹—çš„constructorä¹Ÿæ˜¯æŒ‡å‘Objectï¼Œé‚£ä¹ˆæˆ‘ä»¬äººå’Œç‹—çš„ç±»å‹å°±æ²¡åŠæ³•å»åŒºåˆ†äº†
let dog = createObj('æ—ºè´¢'ï¼Œ 2)
console.log(dog.constructor) //Object æŒ‡å‘çš„æ„é€ å‡½æ•°æ˜¯Object
```

### 3. åˆ©ç”¨æ„é€ å‡½æ•°çš„æ–¹å¼åˆ›å»ºå¯¹è±¡

æ‰§è¡Œçš„è¿‡ç¨‹:

1. ä½¿ç”¨newè¿™ä¸ªå…³é”®è¯æ¥åˆ›å»ºå¯¹è±¡
2. åœ¨æ„é€ å‡½æ•°å†…éƒ¨æŠŠæ–°åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡èµ‹äºˆç»™this
3. åœ¨æ„é€ å‡½æ•°å†…éƒ¨æŠŠæ–°åˆ›å»ºï¼ˆå°†æ¥newçš„å¯¹è±¡ï¼‰çš„å±æ€§æ–¹æ³•ç»‘åˆ°thisä¸Š
4. é»˜è®¤æ˜¯è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯

```js
function Person(name, age) {
  // 1.ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªå¯¹è±¡èµ‹å€¼åˆ°thisä¸Šï¼Œæ­¤æ­¥ä¸éœ€è¦æˆ‘ä»¬æ“ä½œ
  // let this = new Object()

  // 2.ç»™è¿™ä¸ªå¯¹è±¡èµ‹å±æ€§ã€æ–¹æ³•ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ“ä½œ
  this.name = name
  this.age = age
  this.eat = function () {
    console.log(name + 'åƒé¥­')
  }
  // 3.ç³»ç»Ÿè‡ªåŠ¨è¿”å›åˆ›å»ºçš„å¯¹è±¡
  // return this
}
let p3 = new Person('wuyi', 24);
console.log(p3.constructor) //Person æŒ‡å‘çš„æ„é€ å‡½æ•°æ˜¯Person

function Dog(name,age){
    this.name = name
    this.age = age
}

let dog1 = new Dog("æ—ºè´¢",10)
console.log(dog1.constructor) // Dog æŒ‡å‘çš„æ„é€ å‡½æ•°æ˜¯Dog
```

é»˜è®¤æ˜¯è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œç‰¹æ€§éœ€è¦æ³¨æ„çš„æ˜¯:

> å¦‚æœæ˜¾å¼returnä¸€ä¸ªå¯¹è±¡æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆå°†æ¥newçš„å¯¹è±¡ï¼Œå°±æ˜¯æ˜¾å¼returnçš„å¯¹è±¡

æ —å­ğŸŒ°ï¼š

```js
// å½“æˆ‘ä»¬æ˜¾å¼returnä¸€ä¸ªåŸå§‹æ•°æ®ç±»å‹
function Person(name, age) {
  this.name = name
  this.age = age
  return "1"
}
let p = new Person('wuyi', 24); //{name:'wuyi', age:24}
```

```js
// å½“æˆ‘ä»¬æ˜¾å¼returnä¸€ä¸ªå¯¹è±¡æ•°æ®ç±»å‹æ—¶
function Person(name,age){
  this.name = name
  this.age = age
  return [1,2,3]
}
let p = new Person("wuyi",24) // [ 1, 2, 3 ]
// æˆ‘ä»¬å‘ç°ï¼Œå½“æ˜¾å¼returnä¸€ä¸ªå¯¹è±¡æ•°æ®ç±»å‹æ—¶ï¼Œæˆ‘ä»¬newå‡ºæ¥çš„å¯¹è±¡ï¼Œå¾—åˆ°çš„æ˜¯returnçš„å€¼
```

## å®ä¾‹å±æ€§æ–¹æ³•ã€é™æ€å±æ€§æ–¹æ³•ã€åŸå‹å±æ€§æ–¹æ³•

### å®ä¾‹å±æ€§æ–¹æ³•

```js
function Person(name,age){
  // å®ä¾‹å±æ€§
  this.name = name
  this.age = age
  // å®ä¾‹æ–¹æ³•
  this.eat =function() {
    console.log(this.name + 'åƒé¥­')
  }
}
/// é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºå‡ºå®ä¾‹p
let p = new Person("wuyi",24)
// é€šè¿‡å®ä¾‹på»è®¿é—®å®ä¾‹å±æ€§
console.log(p.name) // wuyi
// é€šè¿‡å®ä¾‹på»è®¿é—®å®ä¾‹æ–¹æ³•
p.eat() // wuyiåƒé¥­
```

### é™æ€å±æ€§æ–¹æ³•

ç»‘å®šåœ¨æ„é€ å‡½æ•°ä¸Šçš„å±æ€§æ–¹æ³•ï¼Œéœ€è¦é€šè¿‡æ„é€ å‡½æ•°è®¿é—®

```js
// æ¯”å¦‚æˆ‘ä»¬æƒ³å–å‡ºè¿™ä¸ªPersonæ„é€ å‡½æ•°åˆ›å»ºäº†å¤šå°‘ä¸ªå®ä¾‹
function Person(name, age) {
  this.name = name
  this.age = age
  if (!Person.total) {
    Person.total = 0
  }
  Person.total++
}

let p1 = new Person('å°æ˜',12)
console.log(Person.total) // 1
let p2 = new Person('å°çº¢',11)
console.log(Person.total) // 2
```

### åŸå‹å±æ€§æ–¹æ³•

æ„é€ å‡½æ•°`new`å‡ºæ¥çš„å®ä¾‹ï¼Œéƒ½å…±äº«è¿™ä¸ªæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§æ–¹æ³•ï¼Œç±»ä¼¼å…±äº«åº“ã€‚

```js
function Person(name,age){
  this.name = name
  this.age = age
}

Person.prototype.eat = function(){ // ä½¿ç”¨prototypeæ‰¾åˆ°è¯¥Personçš„åŸå‹å¯¹è±¡
  console.log(this.name + 'åƒé¥­')
}

let p1 = new Person("å°æ˜",12)
let p2 = new Person("å°çº¢",11)
console.log(p1.eat === p2.eat) // true
p1.eat() // å°æ˜åƒé¥­
```

## æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦åŸå‹å¯¹è±¡ï¼ˆå…±äº«åº“ï¼‰ï¼Ÿ

å› ä¸ºé€šè¿‡newç”Ÿæˆçš„å®ä¾‹ï¼Œç›¸å½“äºæ˜¯é‡æ–°å¼€è¾Ÿäº†ä¸€ä¸ªå †åŒºï¼Œè™½ç„¶æ˜¯åŒç±»å‹ï¼Œæ‹¥æœ‰ç±»ä¼¼çš„å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯è¿™äº›å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸æ˜¯ç›¸åŒçš„

```js
function Person(name,age){
  this.name = name
  this.age = age
  this.eat = function(){
    console.log('åƒé¥­')
  }
}

let p1 = new Person("xiaoming",12)
let p2 = new Person("xiaohong",11)

console.log(p1.eat === p2.eat) // false
```

ä»ä¸Šé¢å¯ä»¥å¾—å‡ºï¼Œ`p1`å’Œ`p2`çš„`eat`æ–¹æ³•ï¼Œè¡Œä¸ºæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯ä»–ä»¬å´ä¸ç­‰ï¼Œæ˜¯å› ä¸ºä»–ä»¬ä¸åŒåœ¨ä¸€ä¸ªå †åŒºï¼Œå¦‚æœåªæœ‰1ã€2ä¸ªå®ä¾‹è¿˜å¥½ï¼Œå¦‚æœå¤§é‡çš„å®ä¾‹ï¼Œé‚£ä¹ˆä¼šå¤§é‡ç”Ÿæˆè¿™ç§åŸæœ¬å¯ä»¥å¤ç”¨å…±ç”¨çš„å±æ€§æ–¹æ³•ï¼Œéå¸¸è€—è´¹æ€§èƒ½ï¼Œä¸åˆ©äºå¤ç”¨ã€‚

æ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªç±»ä¼¼å…±äº«åº“çš„å¯¹è±¡ï¼Œè®©å®ä¾‹èƒ½å¤Ÿæ²¿ç€åŸå‹é“¾ï¼Œå»æ‰¾ã€‚

```js
function Person(name){
  this.name = name
}

Person.prototype.eat = function(){ // é€šè¿‡æ„é€ å‡½æ•°Personçš„prototypeå±æ€§æ‰¾åˆ°Personçš„åŸå‹å¯¹è±¡
  console.log('åƒé¥­')
}

let p1 = new Person("xiaoming",12)
let p2 = new Person("xiaohong",11)

console.log(p1.eat === p2.eat) // true
```

è¿™æ ·å¯ä»¥å¢åŠ å¤ç”¨æ€§ï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬è¦ç»™åŸå‹å¯¹è±¡æ·»åŠ å¤§é‡å±æ€§æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ä¸æ–­çš„`Person.prototype.xxx = xxxã€Person.prototype.xxxx = xxxx`ï¼Œè¿™æ ·ä¹Ÿæ˜¯å¾ˆç¹çï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ

```js
function Person(name){
  this.name = name
}
// è®©Person.prototypeæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæ–°çš„å¯¹è±¡
Person.prototype = {
  eat:function(){
    console.log('åƒé¥­')
  },
  sleep:function(){
    console.log('ç¡è§‰')
  }
}
```

![Alt text](./img/Snipaste_2020-06-24_22-22-40.png)

### å¦‚ä½•æ‰¾åˆ°åŸå‹å¯¹è±¡

```js
function Person(name){
  this.name = name
}

Person.prototype = {
  eat:function(){
    console.log('åƒé¥­')
  },
  sleep:function(){
    console.log('ç¡è§‰')
  }
}

let p = new Person('é‚µå¨å„’',28)
// è®¿é—®åŸå‹å¯¹è±¡
console.log(Person.prototype)
console.log(p.__proto__) // __proto__ä»…ç”¨äºæµ‹è¯•ï¼Œä¸èƒ½å†™åœ¨æ­£å¼ä»£ç ä¸­
```

### å’ŒåŸå‹å¯¹è±¡æœ‰å…³å‡ ä¸ªå¸¸ç”¨æ–¹æ³•

#### hasOwnProperty åœ¨å¯¹è±¡è‡ªèº«æŸ¥æ‰¾å±æ€§è€Œä¸åˆ°åŸå‹ä¸ŠæŸ¥æ‰¾

```js
function Person(){
  this.name = 'é‚µå¨å„’'
}

let p = new Person()

let key = 'name'
if((key in p) && p.hasOwnProperty(key)){
  // nameä»…åœ¨på¯¹è±¡ä¸­
}
```

#### isPrototypeOf åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯æŸä¸ªå®ä¾‹çš„åŸå‹å¯¹è±¡

```js
function Person(){
  this.name = 'é‚µå¨å„’'
}

let p = new Person()

let obj = Person.prototype
obj.isPrototypeOf(p) // true
```

### æ›´æ”¹åŸå‹å¯¹è±¡constructoræŒ‡é’ˆ

åŸå‹å¯¹è±¡é»˜è®¤æ˜¯æœ‰ä¸€ä¸ªæŒ‡é’ˆconstructoræŒ‡å‘å…¶æ„é€ å‡½æ•°çš„ï¼Œ

å¦‚æœæˆ‘ä»¬æŠŠæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œæ›¿æ¢æˆå¦å¤–ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°çš„åŸå‹

å¯¹è±¡çš„constructoråˆ™ä¸æ˜¯æŒ‡å‘è¯¥æ„é€ å‡½æ•°ï¼Œä¼šå¯¼è‡´ç±»å‹åˆ¤æ–­çš„é”™è¯¯

```js
function Person(){
  this.name = 'é‚µå¨å„’'
}

Person.prototype = { // æŠŠPersonæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡æ›¿æ¢æˆè¯¥å¯¹è±¡
  eat:function(){
    console.log('åƒé¥­')
  }
}

console.log(Person.prototype.constructor) // Object

// æˆ‘ä»¬å‘ç°ï¼Œè¯¥åŸå‹å¯¹è±¡çš„constructoræŒ‡å‘çš„æ˜¯Objectè€Œä¸æ˜¯Person
// é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨è§£å†³ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼ŒæŠŠåŸå‹å¯¹è±¡çš„constructoræŒ‡å‘åˆ°Person
Person.prototype.constructor = Person
console.log(Person.prototype.constructor) // Person
```

### æ„é€ å‡½æ•°ã€åŸå‹å¯¹è±¡ã€å®ä¾‹ä¹‹é—´çš„å…³ç³»

![Alt text](./img/Snipaste_2020-06-24_22-27-17.png)

## ç»§æ‰¿

é¢å‘å¯¹è±¡çš„ç»§æ‰¿æ–¹å¼æœ‰å¾ˆå¤šç§ï¼ŒåŸå‹é“¾ç»§æ‰¿ã€å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿ã€ç»„åˆç»§æ‰¿ã€åŸå‹å¼ç»§æ‰¿ã€å¯„ç”Ÿå¼ç»§æ‰¿ã€å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿ã€æ·±æ‹·è´ç»§æ‰¿ç­‰ç­‰ã€‚

### åŸå‹é“¾ç»§æ‰¿

åˆ©ç”¨åŸå‹é“¾çš„ç‰¹æ€§ï¼Œå½“åœ¨è‡ªèº«æ‰¾ä¸åˆ°æ—¶ï¼Œä¼šæ²¿ç€åŸå‹é“¾å¾€ä¸Šæ‰¾ã€‚

```js
function Person(){
  this.name = 'é‚µå¨å„’'
  this.pets = ['æ—ºè´¢','å°é»„']
}

Person.prototype.eat = function(){
  console.log('åƒé¥­')
}

function Student(){
  this.num = "030578000"
}
let student = new Student()

console.log(student.num) // '030578000'
console.log(student.name) // undefined
console.log(student.pets) // undefined
student.eat() // æŠ¥é”™
```

ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ`Student`æ²¡æœ‰ç»§æ‰¿`Person`ï¼Œæ­¤æ—¶å®ƒä»¬ä¹‹é—´çš„è”ç³»æ˜¯è¿™æ ·çš„ã€‚

![Alt text](img/Snipaste_2020-06-24_22-29-40.png)

æ—¢ç„¶è¦è®©å®ä¾‹`student`è®¿é—®åˆ°`Person`çš„åŸå‹å¯¹è±¡å±æ€§æ–¹æ³•ï¼Œ

æˆ‘ä»¬ä¼šæƒ³åˆ°ï¼ŒæŠŠ`Student.prototype`æ”¹å†™ä¸º`Person.prototype`

```js
function Person(){
  this.name = 'é‚µå¨å„’'
  this.pets = ['æ—ºè´¢','å°é»„']
}

Person.prototype.eat = function(){
  console.log('åƒé¥­')
}

function Student(){
  this.num = "030578000"
}

// æ”¹å†™Student.prototypeæŒ‡é’ˆæŒ‡å‘
Student.prototype = Person.prototype
let student = new Student()

console.log(student.num)
// '030578000'
console.log(student.name)
// undefined
console.log(student.pets)
// undefined
student.eat()
// 'åƒé¥­'
```

æ­¤æ—¶å…³ç³»å›¾ä¸º

![Alt text](img/Snipaste_2020-06-24_22-30-41.png)

ç°åœ¨ä¿®æ”¹äº†`Student.prototype`æŒ‡é’ˆæŒ‡å‘ä¸º`Person.prototype`åï¼Œå¯ä»¥è®¿é—®`Person.prototype`ä¸Šçš„`eat`æ–¹æ³•ï¼Œä½†æ˜¯`student`è¿˜ä¸èƒ½ç»§æ‰¿`Person.name`å’Œ`Person.pets`ï¼Œé‚£æˆ‘ä¼šæƒ³åˆ°ï¼Œæ˜¯`Person`çš„å®ä¾‹ï¼Œæ‰ä¼šåŒæ—¶æ‹¥æœ‰å®ä¾‹å±æ€§æ–¹æ³•å’ŒåŸå‹å±æ€§æ–¹æ³•ã€‚

```js
function Person(){
  this.name = 'é‚µå¨å„’'
  this.pets = ['æ—ºè´¢','å°é»„']
}

Person.prototype.eat = function(){
  console.log('åƒé¥­')
}

function Student(){
  this.num = "030578000"
}

// newä¸€ä¸ªPersonçš„å®ä¾‹ï¼ŒåŒæ—¶æ‹¥æœ‰å…¶å®ä¾‹å±æ€§æ–¹æ³•å’ŒåŸå‹å±æ€§æ–¹æ³•
let p = new Person()

// æŠŠStudentçš„åŸå‹å¯¹è±¡æŒ‡å‘å®ä¾‹p
Student.prototype = p

// æŠŠStudentçš„åŸå‹å¯¹è±¡çš„constructoræŒ‡å‘Studentï¼Œè§£å†³ç±»å‹åˆ¤æ–­é—®é¢˜
Student.prototype.constructor = Student
let student = new Student()

console.log(student.num)
// '030578000'
console.log(student.name)
// 'é‚µå¨å„’'
console.log(student.pets)
// '[ 'æ—ºè´¢', 'å°é»„' ]'
student.eat()
// 'åƒé¥­'
```

å› ä¸ºå®ä¾‹pæ˜¯ç”±Personæ„é€ å‡½æ•°å®ä¾‹åŒ–å‡ºæ¥çš„ï¼Œæ‰€ä»¥åŒæ—¶æ‹¥æœ‰å…¶å®ä¾‹å±æ€§æ–¹æ³•å’ŒåŸå‹å±æ€§æ–¹æ³•ï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªå®ä¾‹pä½œä¸ºStudentçš„åŸå‹å¯¹è±¡ï¼Œæ­¤æ—¶çš„å…³ç³»å›¾å¦‚ä¸‹

![Alt text](img/Snipaste_2020-06-24_22-33-55.png)

### å€ŸåŠ©æ„é€ å‡½æ•°ç»§æ‰¿

é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼ŒåŸå‹å¯¹è±¡ç±»ä¼¼ä¸€ä¸ªå…±äº«åº“ï¼Œæ‰€æœ‰å®ä¾‹å…±äº«åŸå‹å¯¹è±¡åŒä¸€ä¸ªå±æ€§æ–¹æ³•ï¼Œå¦‚æœåŸå‹å¯¹è±¡ä¸Šæœ‰å¼•ç”¨ç±»å‹ï¼Œé‚£ä¹ˆä¼šè¢«æ‰€æœ‰å®ä¾‹å…±äº«ï¼Œä¹Ÿå°±æ˜¯æŸä¸ªå®ä¾‹æ›´æ”¹äº†ï¼Œåˆ™ä¼šå½±å“å…¶ä»–å®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹

```js
function Person(){
  this.name = 'é‚µå¨å„’'
  this.pets = ['æ—ºè´¢','å°é»„']
}

Person.prototype.eat = function(){
  console.log('åƒé¥­')
}

function Student(){
  this.num = "030578000"
}

let p = new Person()
Student.prototype = p
Student.prototype.constructor = Student

let student = new Student()
let student2 = new Student() // newå¤šä¸€ä¸ªå®ä¾‹

console.log(student.num)
// '030578000'
console.log(student.name)
// 'é‚µå¨å„’'
console.log(student.pets)
// '[ 'æ—ºè´¢', 'å°é»„' ]'
student.eat()
// 'åƒé¥­'

// æ­¤æ—¶æˆ‘ä»¬ä¿®æ”¹æŸä¸€ä¸ªå®ä¾‹ï¼Œpetsæ˜¯åŸå‹å¯¹è±¡ä¸Šçš„å¼•ç”¨ç±»å‹ æ•°ç»„
student.pets.push('å°çº¢')

console.log(student.pets)
// [ 'æ—ºè´¢', 'å°é»„', 'å°çº¢' ]
console.log(student2.pets)
// [ 'æ—ºè´¢', 'å°é»„', 'å°çº¢' ]
```

ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œstudentçš„petsï¼ˆå®é™…å°±æ˜¯åŸå‹å¯¹è±¡ä¸Šçš„petsï¼‰è¢«ä¿®æ”¹åï¼Œç›¸å…³çš„å®ä¾‹student2ä¹Ÿä¼šå—åˆ°å½±å“ã€‚

é‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½æŠŠPersonä¸Šçš„å±æ€§æ–¹æ³•ï¼Œæ·»åŠ åˆ°Studentä¸Šå‘¢ï¼Ÿä»¥é˜²éƒ½å­˜åœ¨åŸå‹å¯¹è±¡ä¸Šï¼Œä¼šè¢«æ‰€æœ‰å®ä¾‹å…±äº«ï¼Œç‰¹åˆ«æ˜¯å¼•ç”¨ç±»å‹çš„ä¿®æ”¹ï¼Œä¼šå½±å“æ‰€æœ‰ç›¸å…³å®ä¾‹ã€‚

å¯ä»¥åˆ©ç”¨callæ¥å®ç°ã€‚

```js
function Person(){
  this.name = 'é‚µå¨å„’'
  this.pets = ['æ—ºè´¢','å°é»„']
}

Person.prototype.eat = function(){
  console.log('åƒé¥­')
}

function Student(){
  // åˆ©ç”¨callè°ƒç”¨Personä¸Šçš„å±æ€§æ–¹æ³•æ‹·è´ä¸€ä»½åˆ°Student
  Person.call(this)  
  this.num = "030578000"
}

let p = new Person()
Student.prototype = p
Student.prototype.constructor = Student

let student = new Student()
let student2 = new Student()

console.log(student.num)
// '030578000'
console.log(student.name)
// 'é‚µå¨å„’'
console.log(student.pets)
// '[ 'æ—ºè´¢', 'å°é»„' ]'
student.eat()
// 'åƒé¥­'

// æ­¤æ—¶æˆ‘ä»¬ä¿®æ”¹æŸä¸€ä¸ªå®ä¾‹ï¼Œpetsæ˜¯åŸå‹å¯¹è±¡ä¸Šçš„å¼•ç”¨ç±»å‹ æ•°ç»„
student.pets.push('å°çº¢')

console.log(student.pets)
// [ 'æ—ºè´¢', 'å°é»„', 'å°çº¢' ]
console.log(student2.pets)
// [ 'æ—ºè´¢', 'å°é»„' ]
```

ä¸Šé¢åœ¨å­æ„é€ å‡½æ•°ï¼ˆStudentï¼‰ä¸­åˆ©ç”¨**callè°ƒç”¨çˆ¶æ„é€ å‡½æ•°**ï¼ˆPersonï¼‰çš„æ–¹å¼ï¼Œå«åš**å€ŸåŠ©æ„é€ å‡½æ•°ç»§æ‰¿**

ç»“åˆä¸Šé¢æ‰€çœ‹ï¼Œ**ä½¿ç”¨äº†åŸå‹é“¾ç»§æ‰¿å’Œå€ŸåŠ©æ„é€ å‡½æ•°ç»§æ‰¿ï¼Œä¸¤è€…ç»“åˆèµ·æ¥ä½¿ç”¨å«ç»„åˆç»§æ‰¿**ï¼Œå…³ç³»å›¾å¦‚ä¸‹ï¼š

![Alt text](img/Snipaste_2020-06-24_22-38-32.png)

é‚£ä¹ˆè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå½“çˆ¶æ„é€ å‡½æ•°éœ€è¦æ¥æ”¶å‚æ•°æ—¶ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ

```js
function Person(name,pets){ // çˆ¶æ„é€ å‡½æ•°æ¥æ”¶nameï¼Œpetså‚æ•°
  this.name = name // èµ‹å€¼åˆ°thisä¸Š
  this.pets = pets // èµ‹å€¼åˆ°thisä¸Š
}

Person.prototype.eat = function(){
  console.log('åƒé¥­')
}

function Student(num,name,pets){ // åœ¨å­æ„é€ å‡½æ•°ä¸­ä¹Ÿæ¥æ”¶å‚æ•°
  Person.call(this,name,pets) // åœ¨è¿™é‡ŒæŠŠnameå’Œpetsä¼ å‚æ•°
  this.num = num // èµ‹å€¼åˆ°thisä¸Š
}

let p = new Person()
Student.prototype = p
Student.prototype.constructor = Student

let student = new Student("030578000","é‚µå¨å„’",["æ—ºè´¢","å°é»„"])
let student2 = new Student("030578001","wuyi",["å°çº¢"])

console.log(student.num)
// '030578000'
console.log(student.name)
// 'é‚µå¨å„’'
console.log(student.pets)
// '[ 'æ—ºè´¢', 'å°é»„' ]'
student.eat()
// 'åƒé¥­'

student.pets.push('å°çº¢')

console.log(student.pets)
// [ 'æ—ºè´¢', 'å°é»„', 'å°çº¢' ]
console.log(student2.pets)
// [ 'å°çº¢' ]
```

![Alt text](img/Snipaste_2020-06-24_22-39-36.png)

è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨å­æ„é€ å‡½æ•°ä¸­ç»™çˆ¶æ„é€ å‡½æ•°ä¼ å‚äº†ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿå‘ç°ä¸Šå›¾ä¸­ï¼Œ2ä¸ªçº¢åœˆçš„åœ°æ–¹ï¼Œä»£ç æ˜¯é‡å¤äº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ

èƒ½å¦åœ¨å­æ„é€ å‡½æ•°è®¾ç½®åŸå‹å¯¹è±¡çš„æ—¶å€™ï¼Œåªè¦çˆ¶æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡å±æ€§æ–¹æ³•å‘¢ï¼Ÿ

å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è®²å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿ï¼Œä¹Ÿæ˜¯ç›®å‰ç¨‹åºçŒ¿è®¤ä¸ºè§£å†³ç»§æ‰¿é—®é¢˜æœ€å¥½çš„æ–¹æ¡ˆã€‚

### å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿

```js
function Person(name,pets){
  this.name = name
  this.pets = pets
}

Person.prototype.eat = function(){
  console.log('åƒé¥­')
}

function Student(num,name,pets){
  Person.call(this,name,pets)
  this.num = num
}

// å¯„ç”Ÿå¼ç»§æ‰¿
// å£°æ˜ä¸€ä¸ªç©ºçš„æ„é€ å‡½æ•°ï¼Œç”¨äºæ¡¥æ¢ä½œç”¨
function Temp(){}

// æŠŠTempæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡æŒ‡å‘Personçš„åŸå‹å¯¹è±¡
Temp.prototype = Person.prototype

// ç”¨æ„é€ å‡½æ•°Tempå®ä¾‹åŒ–ä¸€ä¸ªå®ä¾‹temp
let temp = new Temp()

// æŠŠå­æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡æŒ‡å‘temp
Student.prototype = temp

// æŠŠtempçš„constructoræŒ‡å‘Student
temp.constructor = Student

let student1 = new Student('030578001','é‚µå¨å„’',['æ—ºè´¢','å°é»„'])
console.log(student1)
// Student { name: 'é‚µå¨å„’', pets: [ 'æ—ºè´¢', 'å°é»„' ], num: '030578001' }

let student2 = new Student('030578002','wuyi',['å°çº¢'])
console.log(student2)
// Student { name: 'wuyi', pets: [ 'å°çº¢' ], num: '030578002' }
```

è‡³æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿äº†ï¼Œä¸»è¦é€»è¾‘å°±æ˜¯ç”¨ä¸€ä¸ªç©ºçš„æ„é€ å‡½æ•°ï¼Œæ¥å½“åšæ¡¥æ¢ï¼Œå¹¶ä¸”æŠŠå…¶åŸå‹å¯¹è±¡æŒ‡å‘çˆ¶æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œå¹¶ä¸”å®ä¾‹åŒ–ä¸€ä¸ª`temp`ï¼Œ`temp`ä¼šæ²¿ç€è¿™ä¸ªåŸå‹é“¾ï¼Œå»æ‰¾åˆ°çˆ¶æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡

![Alt text](img/Snipaste_2020-06-24_22-41-46.png)

#### åŸå‹å¼ç»§æ‰¿

```js
// åŸå‹å¼ç»§æ‰¿
function createObjWithObj(obj){ // ä¼ å…¥ä¸€ä¸ªåŸå‹å¯¹è±¡
  function Temp(){}
  Temp.prototype = obj
  let o = new Temp()
  return o
}

// æŠŠPersonçš„åŸå‹å¯¹è±¡å½“åštempçš„åŸå‹å¯¹è±¡
let temp = createObjWithObj(Person.prototype)

// ä¹Ÿå¯ä»¥ä½¿ç”¨Object.createå®ç°
// æŠŠPersonçš„åŸå‹å¯¹è±¡å½“åštemp2çš„åŸå‹å¯¹è±¡
let temp2 = Object.create(Person.prototype)
```

#### å¯„ç”Ÿå¼ç»§æ‰¿

```js
// å¯„ç”Ÿå¼ç»§æ‰¿
// æˆ‘ä»¬åœ¨åŸå‹å¼çš„åŸºç¡€ä¸Šï¼Œå¸Œæœ›ç»™è¿™ä¸ªå¯¹è±¡æ–°å¢ä¸€äº›å±æ€§æ–¹æ³•
// é‚£ä¹ˆæˆ‘ä»¬åœ¨åŸå‹å¼çš„åŸºç¡€ä¸Šæ‰©å±•
function createNewObjWithObj(obj) {
  let o = createObjWithObj(obj)
  o.name = "é‚µå¨å„’"
  o.age = 28
  return o
}
```

## æ·±æ‹·è´ç»§æ‰¿

### æ–¹æ³•ä¸€ åˆ©ç”¨ `JSON.stringify` å’Œ `JSON.parse`

```js
let swr = {
  name:"é‚µå¨å„’",
  age:28
}
let swrCopy = JSON.parse(JSON.stringify(swr))

console.log(swrCopy)
// { name:"é‚µå¨å„’",age:28 }

// æ­¤æ—¶æˆ‘ä»¬ä¿®æ”¹swrçš„å±æ€§
swr.age = 29
console.log(swr)
// { name:"é‚µå¨å„’",age:29 }

// ä½†æ˜¯swrCopyå´ä¸ä¼šå—swrå½±å“
console.log(swrCopy)
// { name:"é‚µå¨å„’",age:28 }
```

è¿™ç§æ–¹å¼è¿›è¡Œæ·±æ‹·è´ï¼Œåªé’ˆå¯¹`json`æ•°æ®è¿™æ ·çš„é”®å€¼å¯¹æœ‰æ•ˆã€‚

å¯¹äºå‡½æ•°ç­‰ç­‰åè€Œæ— æ•ˆï¼Œä¸å¥½ç”¨ï¼Œæ¥ç€ç»§ç»­çœ‹æ–¹æ³•äºŒã€ä¸‰ã€‚

### æ–¹æ³•äºŒ

```js
// æ–¹æ³•äºŒï¼š
function deepCopy(fromObj,toObj) { // æ·±æ‹·è´å‡½æ•°
  // å®¹é”™
  if(fromObj === null) return null // å½“fromObjä¸ºnull
  if(fromObj instanceof RegExp) return new RegExp(fromObj) // å½“fromObjä¸ºæ­£åˆ™
  if(fromObj instanceof Date) return new Date(fromObj) // å½“fromObjä¸ºDate

  toObj = toObj || {}
  
  for(let key in fromObj){ // éå†
    if(typeof fromObj[key] !== 'object'){ // æ˜¯å¦ä¸ºå¯¹è±¡
      toObj[key] = fromObj[key] // å¦‚æœä¸ºåŸå§‹æ•°æ®ç±»å‹ï¼Œåˆ™ç›´æ¥èµ‹å€¼
    }else{
      toObj[key] = new fromObj[key].constructor // å¦‚æœä¸ºobjectï¼Œåˆ™newè¿™ä¸ªobjectæŒ‡å‘çš„æ„é€ å‡½æ•°
      deepCopy(fromObj[key],toObj[key]) // é€’å½’
    }
  }
  
  return toObj
}

let dog = {
  name:"å°ç™½",
  sex:"å…¬",
  friends:[
    {
      name:"å°é»„",
      sex:"æ¯"
    }
  ]
}

let dogCopy = deepCopy(dog)
// æ­¤æ—¶æˆ‘ä»¬æŠŠdogçš„å±æ€§è¿›è¡Œä¿®æ”¹
dog.friends[0].sex = 'å…¬'

console.log(dog)
// { name: 'å°ç™½', sex: 'å…¬', friends: [ { name: 'å°é»„', sex: 'å…¬' } ] }

// å½“æˆ‘ä»¬æ‰“å°dogCopyï¼Œä¼šå‘ç°dogCopyä¸ä¼šå—dogçš„å½±å“
console.log(dogCopy)
// { name: 'å°ç™½', sex: 'å…¬', friends: [ { name: 'å°é»„', sex: 'æ¯' } ] }
```

### æ–¹æ³•ä¸‰

```js
// æ–¹æ³•ä¸‰ï¼š
let dog = {
  name:"å°ç™½",
  sex:"å…¬",
  friends:[
    {
      name:"å°é»„",
      sex:"æ¯"
    }
  ]
}

function deepCopy(obj) {
  if(obj === null) return null
  if(typeof obj !== 'object') return obj
  if(obj instanceof RegExp) return new RegExp(obj)
  if(obj instanceof Date) return new Date(obj)

  let newObj = new obj.constructor
  for(let key in obj){
    newObj[key] = deepCopy(obj[key])
  }

  return newObj
}

let dogCopy = deepCopy(dog)
dog.friends[0].sex = 'å…¬'

console.log(dogCopy)
// { name: 'å°ç™½', sex: 'å…¬', friends: [ { name: 'å°é»„', sex: 'æ¯' } ] }
```
